<mat-toolbar color="primary" class="app-header">
	<!-- Menu Toggle for Mobile -->
	<button
		mat-icon-button
		(click)="toggleSidebar()"
		matTooltip="Toggle menu"
		aria-label="Toggle menu"
		class="menu-toggle"
	>
		<mat-icon>menu</mat-icon>
	</button>

	<!-- Logo/Brand -->
	<span class="app-logo">
		<img
			src="/icons/icon-144x144.png"
			alt="SeventySix Logo"
			class="logo-icon"
		/>
		<span class="app-name">SeventySix</span>
	</span>

	<!-- Spacer -->
	<span class="flex-1"></span>

	<!-- Color Scheme Toggle -->
	<button
		mat-icon-button
		(click)="toggleColorScheme()"
		[matTooltip]="
			'Color: ' +
			(themeService.isBlue()
				? 'Blue → Cyan/Orange'
				: 'Cyan/Orange → Blue')
		"
		aria-label="Toggle color scheme"
	>
		<mat-icon>{{
			themeService.isBlue() ? "water_drop" : "local_fire_department"
		}}</mat-icon>
	</button>

	<!-- Brightness Toggle -->
	<button
		mat-icon-button
		(click)="toggleBrightness()"
		[matTooltip]="
			'Brightness: ' +
			(themeService.isDark() ? 'Dark → Light' : 'Light → Dark')
		"
		aria-label="Toggle brightness"
	>
		<mat-icon>{{
			themeService.isDark() ? "light_mode" : "dark_mode"
		}}</mat-icon>
	</button>

	<!-- Guest Menu (Unauthenticated) -->
	@if (!authService.isAuthenticated())
	{
		<button
			mat-icon-button
			[matMenuTriggerFor]="guestMenu"
			matTooltip="Account"
			aria-label="Account options"
			data-testid="guest-menu-button"
		>
			<mat-icon>person_outline</mat-icon>
		</button>

		<mat-menu #guestMenu="matMenu">
			<button mat-menu-item (click)="navigateToLogin()">
				<mat-icon>login</mat-icon>
				<span>Sign In</span>
			</button>
			<button mat-menu-item (click)="navigateToRegister()">
				<mat-icon>person_add</mat-icon>
				<span>Create Account</span>
			</button>
		</mat-menu>
	}

	<!-- User Menu (Authenticated) -->
	@if (authService.isAuthenticated())
	{
		<button
			mat-icon-button
			[matMenuTriggerFor]="userMenu"
			matTooltip="User menu"
			aria-label="User menu"
			data-testid="user-menu-button"
		>
			<mat-icon>account_circle</mat-icon>
		</button>

		<mat-menu #userMenu="matMenu">
			<div class="user-menu-header" mat-menu-item disabled>
				<span data-testid="user-fullname">{{ displayName() }}</span>
			</div>
			<mat-divider></mat-divider>
			<button mat-menu-item (click)="navigateToProfile()">
				<mat-icon>person</mat-icon>
				<span>Profile</span>
			</button>
			<mat-divider></mat-divider>
			<button mat-menu-item (click)="logout()">
				<mat-icon>logout</mat-icon>
				<span>Logout</span>
			</button>
		</mat-menu>
	}
</mat-toolbar>

<!-- Breadcrumb Navigation (Second Row) -->
<div class="breadcrumb-container">
	<app-breadcrumb></app-breadcrumb>
</div>
