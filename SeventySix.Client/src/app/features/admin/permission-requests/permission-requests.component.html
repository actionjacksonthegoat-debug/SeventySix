<section class="permission-requests-page">
	<header class="page-header">
		<h1>Permission Requests</h1>
	</header>

	@if (isLoading()) {
		<mat-spinner diameter="48"></mat-spinner>
	} @else if (error()) {
		<mat-card appearance="outlined" class="error-card">
			<mat-card-content>{{ error() }}</mat-card-content>
		</mat-card>
	} @else {
		<mat-card>
			<mat-card-content>
				<table mat-table [dataSource]="requests()">
					<ng-container matColumnDef="username">
						<th mat-header-cell *matHeaderCellDef>User</th>
						<td mat-cell *matCellDef="let request">{{ request.username }}</td>
					</ng-container>

					<ng-container matColumnDef="requestedRole">
						<th mat-header-cell *matHeaderCellDef>Role</th>
						<td mat-cell *matCellDef="let request">{{ request.requestedRole }}</td>
					</ng-container>

					<ng-container matColumnDef="requestMessage">
						<th mat-header-cell *matHeaderCellDef>Message</th>
						<td mat-cell *matCellDef="let request">{{ request.requestMessage ?? "-" }}</td>
					</ng-container>

					<ng-container matColumnDef="createdBy">
						<th mat-header-cell *matHeaderCellDef>Requested By</th>
						<td mat-cell *matCellDef="let request">{{ request.createdBy }}</td>
					</ng-container>

					<ng-container matColumnDef="createDate">
						<th mat-header-cell *matHeaderCellDef>Date</th>
						<td mat-cell *matCellDef="let request">{{ request.createDate | date:"short" }}</td>
					</ng-container>

					<tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
					<tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
				</table>

				@if (requests().length === 0) {
					<p class="empty-message">No permission requests found.</p>
				}
			</mat-card-content>
		</mat-card>
	}
</section>
