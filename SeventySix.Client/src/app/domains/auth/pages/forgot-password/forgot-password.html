<div class="forgot-password-container">
	<div class="forgot-password-card">
		@if (submitted()) {
		<div
			class="success-state"
			role="status"
			aria-live="polite">
			<h1>Check Your Email</h1>
			<p>
				If an account exists with that email address, we've sent a password reset link. Please check your inbox
				and spam folder.
			</p>
			<a
				routerLink="/auth/login"
				mat-stroked-button
				color="primary"
				class="submit-button">
				Return to Sign In
			</a>
		</div>
		} @else {
		<h1>Forgot Password</h1>
		<p class="description">
			Enter your email address and we'll send you a link to reset your password.
		</p>

		<form
			[formGroup]="forgotPasswordForm"
			(ngSubmit)="onSubmit()"
			class="forgot-password-form">
			<mat-form-field appearance="outline">
				<mat-label>Email Address</mat-label>
				<input
					matInput
					id="email"
					type="email"
					formControlName="email"
					autocomplete="email"
					placeholder="Enter your email"
					required
					aria-required="true"
					[attr.aria-invalid]="
						forgotPasswordForm.get('email')?.invalid &&
						forgotPasswordForm.get('email')?.touched
					"
				/>
				@if (emailError()) {
				<mat-error>
					{{ emailError() }}
				</mat-error>
				}
			</mat-form-field>

			@if (altchaEnabled) {
			<div class="altcha-container">
				<app-altcha-widget
					[challengeUrl]="challengeUrl"
					[hideFooter]="true"
					(verified)="onAltchaVerified($event)">
				</app-altcha-widget>
			</div>
			}

			<button
				mat-stroked-button
				color="primary"
				type="submit"
				class="submit-button"
				[disabled]="!canSubmit()"
				[attr.aria-busy]="isLoading()">
				@if (isLoading()) { Sending... } @else { Send Reset Link }
			</button>
		</form>

		<div class="back-link">
			<a routerLink="/auth/login">Back to Sign In</a>
		</div>
		}
	</div>
</div>
