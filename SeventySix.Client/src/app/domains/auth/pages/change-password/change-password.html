<div class="change-password-container">
	<div class="change-password-card">
		<h1>Change Password</h1>

		@if (isRequired()) {
		<p
			class="required-notice"
			data-testid="required-notice"
			role="alert">
			You must change your password before continuing.
		</p>
		}

		<form
			[formGroup]="changePasswordForm"
			(ngSubmit)="onSubmit()">
			<mat-form-field appearance="outline">
				<mat-label>Current Password</mat-label>
				<input
					matInput
					type="password"
					id="currentPassword"
					data-testid="current-password-input"
					formControlName="currentPassword"
					autocomplete="current-password"
					aria-required="true"
					[attr.aria-invalid]="
						changePasswordForm.get('currentPassword')?.invalid &&
						changePasswordForm.get('currentPassword')?.touched
					"
				/>
				@if (currentPasswordError()) {
				<mat-error>{{ currentPasswordError() }}</mat-error>
				}
			</mat-form-field>

			<mat-form-field appearance="outline">
				<mat-label>New Password</mat-label>
				<input
					matInput
					type="password"
					id="newPassword"
					data-testid="new-password-input"
					formControlName="newPassword"
					autocomplete="new-password"
					aria-required="true"
					[attr.aria-invalid]="
						changePasswordForm.get('newPassword')?.invalid &&
						changePasswordForm.get('newPassword')?.touched
					"
				/>
				<mat-hint id="newPassword-hint">At least 8 characters with uppercase, lowercase, and a digit</mat-hint>
				@if (newPasswordError()) {
				<mat-error>{{ newPasswordError() }}</mat-error>
				}
			</mat-form-field>

			<mat-form-field appearance="outline">
				<mat-label>Confirm New Password</mat-label>
				<input
					matInput
					type="password"
					id="confirmPassword"
					data-testid="confirm-password-input"
					formControlName="confirmPassword"
					autocomplete="new-password"
					aria-required="true"
					[attr.aria-invalid]="
						changePasswordForm.get('confirmPassword')?.invalid &&
						changePasswordForm.get('confirmPassword')?.touched
					"
				/>
				@if (confirmPasswordError()) {
				<mat-error>{{ confirmPasswordError() }}</mat-error>
				}
			</mat-form-field>

			<button
				mat-stroked-button
				color="primary"
				type="submit"
				data-testid="change-password-submit"
				[disabled]="isLoading() || changePasswordForm.invalid"
				class="submit-button"
				[attr.aria-busy]="isLoading()">
				@if (isLoading()) {
				<span>Changing...</span>
				} @else {
				<span>Change Password</span>
				}
			</button>
		</form>
	</div>
</div>
