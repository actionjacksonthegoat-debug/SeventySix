<div class="change-password-container">
	<div class="change-password-card">
		<h1>Change Password</h1>

		@if (isRequired()) {
		<p
			class="required-notice"
			role="alert">
			You must change your password before continuing.
		</p>
		}

		<form
			[formGroup]="changePasswordForm"
			(ngSubmit)="onSubmit()">
			<div class="form-group required">
				<label for="currentPassword">Current Password</label>
				<input
					type="password"
					id="currentPassword"
					formControlName="currentPassword"
					autocomplete="current-password"
					aria-required="true"
					[attr.aria-invalid]="
						changePasswordForm.get('currentPassword')?.invalid &&
						changePasswordForm.get('currentPassword')?.touched
					"
					aria-describedby="currentPassword-error"
				/>
				@if (currentPasswordError()) {
				<span
					id="currentPassword-error"
					class="error-text">
					{{ currentPasswordError() }}
				</span>
				}
			</div>

			<div class="form-group required">
				<label for="newPassword">New Password</label>
				<input
					type="password"
					id="newPassword"
					formControlName="newPassword"
					autocomplete="new-password"
					aria-required="true"
					[attr.aria-invalid]="
						changePasswordForm.get('newPassword')?.invalid &&
						changePasswordForm.get('newPassword')?.touched
					"
					aria-describedby="newPassword-hint newPassword-error"
				/>
				<small
					id="newPassword-hint"
					class="hint">
					At least 8 characters with uppercase, lowercase, and a digit
				</small>
				@if (newPasswordError()) {
				<span
					id="newPassword-error"
					class="error-text">
					{{ newPasswordError() }}
				</span>
				}
			</div>

			<div class="form-group required">
				<label for="confirmPassword">Confirm New Password</label>
				<input
					type="password"
					id="confirmPassword"
					formControlName="confirmPassword"
					autocomplete="new-password"
					aria-required="true"
					[attr.aria-invalid]="
						changePasswordForm.get('confirmPassword')?.invalid &&
						changePasswordForm.get('confirmPassword')?.touched
					"
					aria-describedby="confirmPassword-error"
				/>
				@if (confirmPasswordError()) {
				<span
					id="confirmPassword-error"
					class="error-text">
					{{ confirmPasswordError() }}
				</span>
				}
			</div>

			<button
				mat-flat-button
				color="primary"
				type="submit"
				[disabled]="isLoading() || changePasswordForm.invalid"
				class="submit-button"
				[attr.aria-busy]="isLoading()">
				@if (isLoading()) {
				<span>Changing...</span>
				} @else {
				<span>Change Password</span>
				}
			</button>
		</form>
	</div>
</div>
