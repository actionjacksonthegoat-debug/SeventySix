// =============================================================================
// SEVENTYSIX GLOBAL STYLES
// =============================================================================
// Material Design 3 theme with blue primary color
// Supports light and dark themes via ThemeService
// =============================================================================

// Import global variables and design tokens
@use "./app/shared/styles/variables" as vars;

// Import Material theme configuration
@use "./app/shared/styles/material-theme" as theme;

// Import base styles and utilities
@use "./app/shared/styles/base";
@use "./app/shared/styles/utilities";

// =============================================================================
// MATERIAL CORE & BASE THEME
// =============================================================================
// Apply core styles, typography, and density once globally
@include theme.apply-base-theme;

// =============================================================================
// GLOBAL RESET & BASE STYLES
// =============================================================================

* {
	box-sizing: border-box;
}

html,
body {
	height: 100%;
	width: 100%;
	margin: 0;
	padding: 0;
	overflow: hidden; // Prevent double scrollbars
}

html {
	// ==========================================================================
	// ROOT FONT SIZE - SITE-WIDE TEXT SCALING
	// ==========================================================================
	// Change this ONE value to scale ALL text site-wide, including Material components.
	// Browser default is 16px. Using percentage allows user browser preferences to work.
	// 100% = 16px (default), 106.25% = 17px, 112.5% = 18px, 87.5% = 14px
	// This affects ALL rem-based sizing (Material typography, spacing, etc.)
	font-size: 100%; // 16px base (default)
}

body {
	font-family: Roboto, "Helvetica Neue", sans-serif;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

// =============================================================================
// THEME CLASSES
// =============================================================================
// Applied dynamically by ThemeService based on user preference
// Supports: light-blue, dark-blue, light-cyan-orange, dark-cyan-orange

// Light Blue Theme
html.light-theme.blue-scheme {
	@include theme.apply-light-blue-theme;
	background-color: var(--mat-sys-surface);
	color: var(--mat-sys-on-surface);
}

// Dark Blue Theme
html.dark-theme.blue-scheme {
	@include theme.apply-dark-blue-theme;
	background-color: var(--mat-sys-surface);
	color: var(--mat-sys-on-surface);
}

// Light Cyan-Orange Theme
html.light-theme.cyan-orange-scheme {
	@include theme.apply-light-cyan-orange-theme;
	background-color: var(--mat-sys-surface);
	color: var(--mat-sys-on-surface);
}

// Dark Cyan-Orange Theme
html.dark-theme.cyan-orange-scheme {
	@include theme.apply-dark-cyan-orange-theme;
	background-color: var(--mat-sys-surface);
	color: var(--mat-sys-on-surface);
}

// Default to light blue theme if no classes are applied yet
html:not(.light-theme):not(.dark-theme) {
	@include theme.apply-light-blue-theme;
	background-color: var(--mat-sys-surface);
	color: var(--mat-sys-on-surface);
}

// =============================================================================
// BASE ELEMENT STYLES & UTILITY CLASSES
// =============================================================================
// Imported at the top of the file using @use instead of @import

// =============================================================================
// MATERIAL COMPONENT GLOBAL OVERRIDES
// =============================================================================
// Minimal global customizations - prefer component-level styles

// Enhanced focus visibility for accessibility
*:focus-visible {
	outline: 2px solid var(--mat-sys-primary);
	outline-offset: 2px;
	border-radius: 2px;
}

// Remove focus outline for mouse users (but keep for keyboard)
*:focus:not(:focus-visible) {
	outline: none;
}

// Ensure Material buttons have visible focus indicators
.mat-mdc-button:focus-visible,
.mat-mdc-raised-button:focus-visible,
.mat-mdc-outlined-button:focus-visible,
.mat-mdc-fab:focus-visible,
.mat-mdc-mini-fab:focus-visible,
.mat-mdc-icon-button:focus-visible {
	outline: 2px solid var(--mat-sys-primary);
	outline-offset: 2px;
}

// =============================================================================
// MATERIAL FORM FIELD SUFFIX BUTTONS
// =============================================================================
// Style suffix icon buttons to match the input's right-side border radius
// Creates a filled right-side appearance for all input action buttons

.mat-mdc-form-field {
	// Reserve space for suffix button to prevent text overflow
	input[matInput] {
		padding-right: vars.$form-field-height-dense; // 48px - matches suffix width
	}

	// Style the suffix button
	button[matIconSuffix] {
		width: vars.$avatar-size-base; // 40px
		height: vars.$avatar-size-base;
		border-radius: 0 vars.$border-radius-sm vars.$border-radius-sm 0;
		margin-right: vars.$spacing-xs;

		// Remove circular ripple effect, use rectangular shape
		.mat-mdc-button-persistent-ripple,
		.mat-mdc-button-ripple {
			border-radius: 0 vars.$border-radius-sm vars.$border-radius-sm 0;
		}

		// Override Material's hover state circle
		.mat-mdc-button-persistent-ripple::before {
			border-radius: 0 vars.$border-radius-sm vars.$border-radius-sm 0;
		}
	}
}

// Ensure Material cards have proper spacing
.mat-mdc-card {
	margin-bottom: vars.$spacing-md;
}

// =============================================================================
// MATERIAL CHIPS - GLOBAL CUSTOMIZATION
// =============================================================================
// Consistent chip styling across the entire application
// Fixes icon alignment and provides uniform padding

// All chips (mat-chip, mat-chip-option)
mat-chip,
mat-chip-option {
	min-height: vars.$button-height-sm; // 32px

	// Fix chip action padding for consistent spacing
	.mdc-evolution-chip__action--primary {
		padding-left: vars.$spacing-md; // 12px
		padding-right: vars.$spacing-md; // 12px
		min-height: vars.$button-height-sm; // 32px
	}

	// Fix chip graphic (icon container) alignment
	.mdc-evolution-chip__graphic {
		padding-left: 0;
		padding-right: 0;
		margin-right: vars.$spacing-xs; // 4px
		display: flex;
		align-items: center;
		justify-content: center;
	}

	// Fix text label alignment
	.mdc-evolution-chip__text-label {
		display: flex;
		align-items: center;
		gap: vars.$spacing-xs; // 4px - close icon spacing
	}

	// Fix icon sizing and alignment
	mat-icon {
		font-size: vars.$icon-size-sm; // 18px
		width: vars.$icon-size-sm;
		height: vars.$icon-size-sm;
		line-height: vars.$icon-size-sm;
		display: inline-flex;
		align-items: center;
		justify-content: center;
		margin: 0;
	}
}

// Smaller chips in mobile view
@media #{vars.$breakpoint-mobile} {
	mat-chip,
	mat-chip-option {
		.mdc-evolution-chip__action--primary {
			padding-left: vars.$spacing-sm; // 8px
			padding-right: vars.$spacing-sm;
		}

		mat-icon {
			font-size: vars.$icon-size-xs;
			width: vars.$icon-size-xs;
			height: vars.$icon-size-xs;
			line-height: vars.$icon-size-xs;
		}
	}
}

// =============================================================================
// MATERIAL DROPDOWNS - MINIMAL CUSTOMIZATION
// =============================================================================
// Add padding and reduce height for dropdowns to improve compactness
.mat-mdc-select {
	// Add left and right padding
	padding-left: vars.$spacing-md; // 12px
	padding-right: vars.$spacing-sm; // 8px
}

// Reduce overall height
.mat-mdc-form-field-infix {
	min-height: vars.$button-height-sm; // 32px
	padding-top: vars.$spacing-xs; // 4px
	padding-bottom: vars.$spacing-xs;
}

// =============================================================================
// GLOBAL SCROLLBAR STYLING
// =============================================================================
// Theme-aware scrollbar using CSS custom properties from Material theme

html {
	// Firefox scrollbar
	scrollbar-width: thin;
	scrollbar-color: var(--mat-sys-outline) var(--mat-sys-surface-variant);

	// Webkit scrollbar
	::-webkit-scrollbar {
		width: 0.75rem; // 12px at 16px base
		height: 0.75rem;
	}

	::-webkit-scrollbar-track {
		background: var(--mat-sys-surface-variant);
	}

	::-webkit-scrollbar-thumb {
		background: var(--mat-sys-outline);
		border-radius: vars.$border-radius-sm;

		&:hover {
			background: var(--mat-sys-on-surface-variant);
		}
	}
}

// =============================================================================
// MATERIAL DIALOG GLOBAL STYLING
// =============================================================================
// Ensures all dialogs align with main content and are responsive
// Dialog positioning uses body.sidebar-expanded class set by app component

// CDK Overlay container - ensure dialog centering
.cdk-overlay-container {
	// Ensure overlay is centered by default
	display: flex;
	justify-content: center;
	align-items: center;
}

// Dialog panel positioning - offset when sidebar is expanded on desktop
.cdk-overlay-pane.mat-mdc-dialog-panel {
	// Default: centered in viewport (sidebar closed or overlay mode)

	// When sidebar is expanded in side mode, offset dialog to center in remaining space
	@media #{vars.$breakpoint-desktop} {
		body.sidebar-expanded & {
			// Offset by half the sidebar width to center in remaining viewport
			margin-left: calc(vars.$sidebar-width / 2);
		}
	}
}

// Dialog container responsive styling
.mat-mdc-dialog-container {
	// Ensure dialogs have proper border radius
	border-radius: vars.$border-radius-dialog !important;

	.mat-mdc-dialog-surface {
		border-radius: vars.$border-radius-dialog !important;
	}
}

// Dialog backdrop - darker mask for better focus
.cdk-overlay-dark-backdrop {
	background-color: var(--color-backdrop);
}

// Dialog content centering and responsive styling
.mat-mdc-dialog-content {
	max-height: 70vh;
	overflow-y: auto;
	@include vars.custom-scrollbar();
}

// =============================================================================
// INTERACTIVE TABLE ROWS - GLOBAL CLASSES
// =============================================================================
// Global classes for interactive rows when mixin approach doesn't work
// Components should use the @include vars.interactive-row-hover() mixin

// Light theme row hover
html.light-theme {
	.interactive-row,
	.data-row {
		cursor: pointer;
		transition: background-color vars.$transition-duration-fast
			vars.$transition-easing-standard;

		&:hover {
			background-color: var(--color-hover);
		}

		&:active {
			background-color: var(--color-pressed);
		}
	}
}

// Dark theme row hover
html.dark-theme {
	.interactive-row,
	.data-row {
		cursor: pointer;
		transition: background-color vars.$transition-duration-fast
			vars.$transition-easing-standard;

		&:hover {
			background-color: var(--color-hover);
		}

		&:active {
			background-color: var(--color-pressed);
		}
	}
}
