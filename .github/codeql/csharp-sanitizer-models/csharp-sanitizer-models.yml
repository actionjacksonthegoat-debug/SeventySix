# CodeQL Models-as-Data: SeventySix.Shared.Utilities.LogSanitizer taint sanitizers.
#
# Declares MaskEmail, MaskEmailSubject, MaskUsername, and Sanitize as neutral
# (no-flow-through) methods for CodeQL's cs/exposure-of-sensitive-information rule.
# These are purpose-built PII masking functions — their output does not carry sensitive
# taint from their input.
#
# A neutralModel with kind "summary" tells CodeQL that calling the method does not
# propagate taint from its arguments to its return value, effectively breaking the
# taint-tracking chain at the point where PII is masked before logging.
#
# Reference:
#   https://codeql.github.com/docs/codeql-language-guides/customizing-library-models-for-csharp/
#   neutralModel format: ["namespace", "type", "method-name", "signature", "kind", "provenance"]
extensions:
  - addsTo:
      pack: codeql/csharp-all
      extensible: neutralModel
    data:
      # MaskEmail(string?) → safe masked string — taint does NOT flow through
      - ["SeventySix.Shared.Utilities", "LogSanitizer", "MaskEmail", "(System.String)", "summary", "manual"]
      # MaskUsername(string?) → safe masked string
      - ["SeventySix.Shared.Utilities", "LogSanitizer", "MaskUsername", "(System.String)", "summary", "manual"]
      # MaskEmailSubject(string?) → safe category label (no PII, maps to category)
      - ["SeventySix.Shared.Utilities", "LogSanitizer", "MaskEmailSubject", "(System.String)", "summary", "manual"]
      # Sanitize(string?) → safe sanitized string for log output
      - ["SeventySix.Shared.Utilities", "LogSanitizer", "Sanitize", "(System.String)", "summary", "manual"]
