# CodeQL Models-as-Data: SeventySix.Shared.Utilities.LogSanitizer taint sanitizers.
#
# Declares MaskEmail, MaskEmailSubject, and MaskUsername as taint-sanitizers for
# CodeQL's cs/exposure-of-sensitive-information rule. These are purpose-built PII
# masking functions — their output does not carry sensitive taint from their input.
#
# Without this model, CodeQL cannot infer that the return value of MaskEmail("user@x.com")
# is safe to log; it sees the input as tainted (email) and conservatively flags log calls
# that use the return value.
#
# Reference:
#   https://codeql.github.com/docs/codeql-language-guides/using-customizations-for-csharp/
#   Format: ["fully-qualified-type", "method-name", "input-spec", "output-spec", "kind", "provenance"]
extensions:
  - addsTo:
      pack: codeql/csharp-all
      extensible: summaryModel
    data:
      # MaskEmail(string?) → safe masked string — taint does NOT flow through
      - ["SeventySix.Shared.Utilities.LogSanitizer", "MaskEmail", "Argument[0]", "ReturnValue", "taint", "manual"]
      # MaskUsername(string?) → safe masked string
      - ["SeventySix.Shared.Utilities.LogSanitizer", "MaskUsername", "Argument[0]", "ReturnValue", "taint", "manual"]
      # MaskEmailSubject(string?) → safe category label
      - ["SeventySix.Shared.Utilities.LogSanitizer", "MaskEmailSubject", "Argument[0]", "ReturnValue", "taint", "manual"]